@model ManufacturingManagement_V2.Models.AAA_MedicalTest
@{
    ViewBag.Title = "UpdateMedicalIndex";
    Layout = "~/views/shared/_LayoutCommon.cshtml";
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Update Record</title>
    <script>
        $(document).ready(function () {
            $('#Apply').prop('disabled', true);
            $("#files").change(function () {
                // Get uploaded file extension
                var extension = $(this).val().split('.').pop().toLowerCase();
                // Create array with the files extensions that we wish to upload
                var validFileExtensions = ['doc', 'docx', 'pdf', 'ppt', 'xls', 'xlsx'];
                // var validFileExtensions = ['pdf'];
                //Check file extension in the array.if -1 that means the file extension is not in the list.
                if ($.inArray(extension, validFileExtensions) == -1) {
                    alert("Sorry!! Upload only 'doc', 'docx', 'pdf', 'ppt','xls' file")
                    // alert("Sorry!! Upload only 'doc', 'docx', 'pdf' 'ppt' file")
                    // Clear fileuload control selected file
                    $(this).replaceWith($(this).val('').clone(true));
                    //Disable Submit Button
                    $('#Apply').prop('disabled', true);
                } else {
                    // Check and restrict the file size to 128 KB.
                    if ($(this).get(0).files[0].size > (131072131)) {
                        alert("Sorry!! Max allowed file size is 2MB");
                        // Clear fileuload control selected file
                        $(this).replaceWith($(this).val('').clone(true));
                        //Disable Submit Button
                        $('#Apply').prop('disabled', true);
                    } else {
                        //Enable Submit Button
                        $('#Apply').prop('disabled', false);
                    }
                }
            });
            $("#Apply").click(function () {
                if ($("#Location").val() = null) {
                    alert("Please fill out required fields(*)");
                    return false;
                }
                return true;
            });
        });
        function GetVacDetails(id) {
            $.ajax({
                url: "/B_MedicalTest/Update_Medical_Record/" + id,
                typr: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (response) {
                    $('#NewEmpId1').val(response.NewEmpId);
                    $('#EmpName1').val(response.EmpName);
                    $('#modal-Insert').modal('show');
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
            return false;
        }



        function GetDetails(id) {
            $.ajax({
                url: "/B_MedicalTest/Update_Medical_Record/" + id,
                typr: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (response) {
                    $('#MedicalId').val(response.MedicalId);
                    $('#cmpname').val(response.cmpname);
                    $('#GradeName').val(response.GradeName);
                    $('#NewEmpId').val(response.NewEmpId);
                    $('#EmpId').val(response.EmpId);
                    $('#Age').val(response.Age);
                    $('#Weight').val(response.Weight);
                    $('#Hemoglobin').val(response.Hemoglobin);
                    $('#Pulse').val(response.Pulse);
                    $('#Oxygen').val(response.Oxygen);
                    $('#Sugar').val(response.Sugar);
                    $('#Bp').val(response.Bp);
                    $('#Bplow').val(response.Bplow);
                    $('#BloodGroup').val(response.BloodGroup);
                    $('#Height').val(response.Height);
                    $('#EyeSight').val(response.EyeSight);
                    $('#Allergies').val(response.Allergies);
                    $('#HealthCondition').val(response.HealthCondition);
                    $('#Remark').val(response.Remark);
                    $('#modal-Update').modal('show');
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
            return false;
        }

        function GetVacDetailsUpdate(RecordId) {
            $.ajax({
                url: "/B_MedicalTest/VaccinationUpdate_Record/" + RecordId,
                typr: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                success: function (response) {
                    $('#RecordId').val(response.RecordId);
                    $('#VacId2').val(response.VacId);
                    $('#Dose2').val(response.Dose1);
                    $('#Dose2').val(response.Dose2);
                    $('#Dose1Date2').val(response.Dose1Date);
                    $('#Dose2Date2').val(response.Dose2Date);
                    $('#modal-VacUpdate').modal('show');
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
            return false;
        }

    </script>
</head>
<body style="overflow:hidden">
    @*<div class="pull-left">
              @Html.ActionLink("AddNew", "AddNewRecord", "B_MedicalTest", null, new { @class = "btn btn-success" })
          </div>
          <div id="printbar" class="pull-right" style="margin-right:3px;margin-bottom:3px;margin-top:3px">
        </div>*@
    <div style="font-family:Arial">
        <script src="~/Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
        <script src="~/Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript"></script>
        <div class="pull-right">
            @*<button type="button" class="btn btn-success" data-toggle="modal" data-target="#modal-Insert" style="margin-right:3px;margin-bottom:3px;margin-top:3px;margin-left:2px">
                    Add New
                </button>*@
            @Html.ActionLink("AddNew", "AddNewRecord", "B_MedicalTest", null, new { @class = "btn btn-success" })
            @*<div id="printbar" class="pull-left" style="margin-right:3px;margin-bottom:3px;margin-top:3px">
                </div>*@
        </div>
        @Ajax.ActionLink("Vaccinated List", "GetEmpVaccineList", new AjaxOptions
        {
            HttpMethod = "GET", // HttpMethod to use, GET or POST
       UpdateTargetId = "divStudents", // ID of the HTML element to update
       InsertionMode = InsertionMode.Replace // Replace the existing contents
   })
        <span style="color:Blue;">|</span>
        <span style="color:Blue;"></span>


        <div id="divStudents">

        </div>
    </div>

    <section class="content">
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary">
                    <div class="box-header">
                    </div>
                    <table id="jdtabledesktop" class="display nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <th>Action</th>
                                <th>Vaccine</th>
                                <th>Company</th>
                                <th>Grade</th>
                                <th>EmpId</th>
                                <th>EmpName</th>
                                <th>Age</th>
                                <th>TestDate</th>
                                <th>Weight</th>
                                <th>Hemoglobin</th>
                                <th>Pulse</th>
                                <th>Oxygen</th>
                                <th>Sugar/PP</th>
                                <th>BP</th>
                                <th>BPLOW</th>
                                <th>BGroup</th>
                                <th>Height</th>
                                <th>EyeSight</th>
                                <th>Allergies</th>
                                <th>HCondition</th>
                                <th>Remark</th>
                                <th>TId</th>
                                <th>Id</th>

                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.List)
                            {
                                <tr>
                                    <td>
                                        @*<a onclick="GetVacDetails(@item.MedicalId)">
                                                <i class="fa fa-edit">
                                                </i>
                                            </a>*@
                                        <a onclick="GetDetails(@item.MedicalId)">
                                            <i class="fa fa-edit">
                                            </i>
                                        </a>
                                        <a>
                                            @Html.ActionLink(" ", "DeleteMedicalTestRecord", "B_MedicalTest", new { id = item.MedicalId }, new { onclick = "return confirm('Are you sure wants to delete?');", @class = "fa fa-trash-o" })
                                        </a>
                                    </td>
                                    <td>
                                        <a onclick="GetVacDetails(@item.MedicalId)">
                                            <i class="fa fa-edit">
                                            </i>
                                        </a>
                                       </td>
                                    <td>@Html.DisplayFor(model => item.cmpname)</td>
                                    <td>@Html.DisplayFor(model => item.GradeName)</td>
                                    <td>@Html.DisplayFor(model => item.EmpId)</td>
                                    <td>@Html.DisplayFor(model => item.EmpName)</td>
                                    <td>@Html.DisplayFor(model => item.Age)</td>
                                    <td>@Html.DisplayFor(model => item.TestDate)</td>
                                    <td>@Html.DisplayFor(model => item.Weight)</td>
                                    <td>@Html.DisplayFor(model => item.Hemoglobin)</td>
                                    <td>@Html.DisplayFor(model => item.Pulse)</td>
                                    <td>@Html.DisplayFor(model => item.Oxygen)</td>
                                    <td>@Html.DisplayFor(model => item.Sugar)</td>
                                    <td>@Html.DisplayFor(model => item.Bp)</td>
                                    <td>@Html.DisplayFor(model => item.Bplow)</td>
                                    <td>@Html.DisplayFor(model => item.BloodGroup)</td>
                                    <td>@Html.DisplayFor(model => item.Height)</td>
                                    <td>@Html.DisplayFor(model => item.EyeSight)</td>
                                    <td>@Html.DisplayFor(model => item.Allergies)</td>
                                    <td>@Html.DisplayFor(model => item.HealthCondition)</td>
                                    <td>@Html.DisplayFor(model => item.Remark)</td>
                                    <td>@Html.DisplayFor(model => item.MedicalId)</td>
                                    <td>@Html.DisplayFor(model => item.NewEmpId)</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

    </section>
    <div class="modal fade" id="modal-Update">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header with-border">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h3 class="box-title"> Update Record</h3>
                </div>
                <div class="modal-body">
                    <div class="box box-primary">
                        @using (Html.BeginForm("Update_MedicalTest", "B_MedicalTest", FormMethod.Post))
                        {
                            <div class="modal-body" style="height:700px;width:400px;background-color:white">
                                <div class="col-lg-10">
                                    <div class="form-group">
                                        <label>Id</label>
                                        <input type="number" class="form-control" id="MedicalId" name="MedicalId" readonly="readonly">
                                        <label>Company</label>
                                        @Html.DropDownListFor(model => model.Compcode, ViewBag.CompanyList as SelectList)
                                        <label>Grade</label>
                                        <br />
                                        @Html.DropDownListFor(model => model.Grade, ViewBag.GradeList as SelectList)
                                        <br />
                                        <label>EmpId</label>
                                        <input type="number" class="form-control" id="NewEmpId" name="NewEmpId" readonly="readonly">
                                        <label>Weight</label>
                                        <input type="text" class="form-control" id="Weight" name="Weight">
                                        <label>Hemoglobin</label>
                                        <input type="text" class="form-control" id="Hemoglobin" name="Hemoglobin">
                                        <label>Pulse</label>
                                        <input type="text" class="form-control" id="Pulse" name="Pulse">

                                        <label>Oxygen</label>
                                        <input type="text" class="form-control" id="Oxygen" name="Oxygen">

                                        <label>Sugar/PP</label>
                                        <input type="text" class="form-control" id="Sugar" name="Sugar">

                                        <label>BPHigh</label>
                                        <input type="text" class="form-control" id="Bp" name="Bp">
                                        <label>BPLow</label>
                                        <input type="text" class="form-control" id="Bplow" name="Bplow">

                                        <label>BloodGroup</label>
                                        <input type="text" class="form-control" id="BloodGroup" name="BloodGroup">
                                        <label>Height</label>
                                        <input type="text" class="form-control" id="Height" name="Height">

                                        <label>EyeSight</label>
                                        <input type="text" class="form-control" id="EyeSight" name="EyeSight">
                                        <label>Allergies</label>
                                        <input type="text" class="form-control" id="Allergies" name="Allergies">

                                        <label>HealthCondition</label>
                                        <input type="text" class="form-control" id="HealthCondition" name="HealthCondition">
                                        <label>Remark</label>
                                        <input type="text" class="form-control" id="Remark" name="Remark">
                                        @Html.HiddenFor(model => model.UpdateStatus)
                                        @Html.HiddenFor(model => model.UserId)
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-primary">Update</button>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modal-Insert">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header with-border">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h3 class="box-title"> Vaccination Entry</h3>
                </div>
                <div class="modal-body">
                    <div class="box box-primary">
                        @using (Html.BeginForm("IndexVaccine", "B_MedicalTest", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()

                            <div>
                                @*  <hr />*@
                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                @Html.HiddenFor(model => model.MedicalId, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.HiddenFor(model => model.UserId, new { htmlAttributes = new { @class = "form-control" } })
                                <input type="hidden" class="form-control" id="NewEmpId1" name="NewEmpId" />
                                &nbsp;&nbsp;&nbsp;<label>EmpName</label>
                                <br />
                                <input type="text" class="form-control" id="EmpName1" name="EmpName1" style="width:350px;height:25px;margin-left:5px" />
                            </div>
                            <div>

                                &nbsp;&nbsp;&nbsp;<label>Vaccine Type</label>
                                <br />
                                <div class="col-md-4">
                                    @Html.DropDownListFor(model => model.VacId, ViewBag.VacType as SelectList)
                                </div>
                                <br />
                                &nbsp;&nbsp;&nbsp; <label>Dose1</label>
                                @Html.CheckBoxFor(model => model.Dose1)
                                <br />
                                <div class="form-group">
                                    &nbsp;&nbsp;&nbsp; <label>Dose1 Date</label>
                                    <br />
                                    <div class="col-md-4">
                                        @Html.EditorFor(model => model.Dose1Date, new { htmlAttributes = new { @class = "form-control" } })
                                        @Html.ValidationMessageFor(model => model.Dose1Date, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;<label>Dose2</label>
                                @Html.CheckBoxFor(model => model.Dose2)
                                <br />
                                <div class="form-group">
                                    &nbsp;&nbsp;&nbsp; <label>Dose2 Date</label>
                                    <br />
                                    <div class="col-md-4">
                                        @Html.EditorFor(model => model.Dose2Date, new { htmlAttributes = new { @class = "form-control" } })
                                        @Html.ValidationMessageFor(model => model.Dose2Date, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <br />
                                <div class="form-group">
                                    &nbsp;&nbsp;&nbsp;<label>Attached Certificate</label>
                                    <br />
                                    <div class="col-md-10">
                                        @Html.TextBoxFor(model => model.files, "", new { @type = "file", @multiple = "multiple" })
                                        @Html.ValidationMessageFor(model => model.files, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" id="Apply" class="btn btn-success">Submit</button>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*//updateVaccine*@
    <div class="modal fade" id="modal-VacUpdate">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header with-border">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h3 class="box-title"> Vaccination Entry</h3>
                </div>
                <div class="modal-body">
                    <div class="box box-primary">
                        @using (Html.BeginForm("IndexVaccine", "B_MedicalTest", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            <div>
                                @*  <hr />*@
                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                @Html.HiddenFor(model => model.UserId, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.HiddenFor(model => model.RecordId, new { htmlAttributes = new { @class = "form-control" } })
                                @*<div class="form-group">
                                        &nbsp;&nbsp;&nbsp;<label>EmpName</label>
                                        <br />
                                        @Html.DropDownListFor(model => model.NewEmpId, ViewBag.EmpName as SelectList, "Select")
                                        @Html.ValidationMessageFor(model => model.NewEmpId, "", new { @class = "text-danger" })
                                    </div>*@
                            </div>
                            <div>

                                &nbsp;&nbsp;&nbsp;<label>Vaccine Type</label>
                                <br />
                                <div class="col-md-4">
                                    @Html.DropDownListFor(model => model.VacId, ViewBag.VacType as SelectList)
                                </div>
                                <br />
                                &nbsp;&nbsp;&nbsp; <label>Dose1</label>
                                @Html.CheckBoxFor(model => model.Dose1)
                                <br />
                                <div class="form-group">
                                    &nbsp;&nbsp;&nbsp; <label>Dose1 Date</label>
                                    <br />
                                    <div class="col-md-4">
                                        @Html.EditorFor(model => model.Dose1Date, new { htmlAttributes = new { @class = "form-control" } })
                                        @Html.ValidationMessageFor(model => model.Dose1Date, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;<label>Dose2</label>
                                @Html.CheckBoxFor(model => model.Dose2)
                                <br />
                                <div class="form-group">
                                    &nbsp;&nbsp;&nbsp; <label>Dose2 Date</label>
                                    <br />
                                    <div class="col-md-4">
                                        @Html.EditorFor(model => model.Dose2Date, new { htmlAttributes = new { @class = "form-control" } })
                                        @Html.ValidationMessageFor(model => model.Dose2Date, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <br />
                                @*<div class="form-group">
                                        &nbsp;&nbsp;&nbsp;<label>Attached Certificate</label>
                                        <br />
                                        <div class="col-md-10">
                                            @Html.TextBoxFor(model => model.files, "", new { @type = "file", @multiple = "multiple" })
                                            @Html.ValidationMessageFor(model => model.files, "", new { @class = "text-danger" })
                                        </div>
                                    </div>*@
                            </div>
                            <div class="modal-footer">
                                <button type="submit" id="Apply" class="btn btn-success">Submit</button>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*<script src="~/Script/Sitep.js"></script>*@
    <script src="~/Script/Site.js"></script>
</body>
</html>

